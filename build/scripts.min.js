"use strict";function templateUrl(e){return"./afl_quest/views/"+e+".html?t="+globalTimestamp}function AeroexpressController(e){var t=this;t.goAnotherLocation=e.goAnotherLocation}function AircraftController(e){var t=this;t.playAgain=e.playAgain}function AirportController(e){var t=this;t.goAnotherLocation=e.goAnotherLocation}function BedroomController(e,t){var o=this;o.objects=t.allObjects.bedroom,o.takeObject=e.takeObject,o.goAnotherLocation=e.goAnotherLocation}function GlobalController(e,t){var o=this;o.hostname=function(){var e=window.location.protocol,t="//"+window.location.hostname;return e+t},console.log(location),o.configApp=e,o.gameOn=t.gameOn,o.hideAttention=t.hideAttention}function IndexController(){}function KitchenController(e,t){var o=this;o.objects=t.allObjects.kitchen,o.takeObject=e.takeObject,o.goAnotherLocation=e.goAnotherLocation}function LoserController(e){var t=this;t.playAgain=e.playAgain}function RailwayStationController(e){var t=this;t.goAnotherLocation=e.goAnotherLocation}function StreetController(e){var t=this;t.goAnotherLocation=e.goAnotherLocation}function TaxiController(e){var t=this;t.goAnotherLocation=e.goAnotherLocation}angular.module("app",["ui.router","LocalStorageModule","ngSanitize","ui-notification"]).config(["$locationProvider","localStorageServiceProvider","$qProvider","NotificationProvider",function(e,t,o,r){e.html5Mode(!1).hashPrefix("!"),t.setPrefix("AFLQ"),o.errorOnUnhandledRejections(!1),r.setOptions({startTop:130})}]),angular.module("app").run(["$rootScope","$state","$stateParams","globalService",function(e,t,o,r){e.$state=t,e.$stateParams=o,e.$on("$stateChangeStart",function(t,o,r,a,n){e.title=o.data.title,e.tmplClass=o.data.tmplClass}),e.$on("$stateChangeSuccess",function(e,t,o,a,n){r.checkQuestStatus(e,t,o,a,n)})}]).config(["$urlRouterProvider","$stateProvider",function(e,t){e.otherwise("/"),t.state("index",{"abstract":!0,templateUrl:templateUrl("index"),controller:"IndexController"}).state("bedroom",{url:"/",templateUrl:templateUrl("bedroom"),controller:"BedroomController",controllerAs:"bedroomCtrl",data:{title:"Аэрофлот Quest",tmplClass:"bedroom"},parent:"index"}).state("kitchen",{url:"/kitchen",templateUrl:templateUrl("kitchen"),controller:"KitchenController",controllerAs:"kitchenCtrl",data:{title:"Аэрофлот Quest",tmplClass:"kitchen"},parent:"index"}).state("street",{url:"/street",templateUrl:templateUrl("street"),controller:"StreetController",controllerAs:"streetCtrl",data:{title:"Аэрофлот Quest",tmplClass:"street"},parent:"index"}).state("taxi",{url:"/taxi",templateUrl:templateUrl("taxi"),controller:"TaxiController",controllerAs:"taxiCtrl",data:{title:"Аэрофлот Quest",tmplClass:"taxi"},parent:"index"}).state("railway-station",{url:"/railway-station",templateUrl:templateUrl("railway-station"),controller:"RailwayStationController",controllerAs:"railwayStationCtrl",data:{title:"Аэрофлот Quest",tmplClass:"railway-station"},parent:"index"}).state("aeroexpress",{url:"/aeroexpress",templateUrl:templateUrl("aeroexpress"),controller:"AeroexpressController",controllerAs:"aeroexpressCtrl",data:{title:"Аэрофлот Quest",tmplClass:"aeroexpress"},parent:"index"}).state("airport",{url:"/airport",templateUrl:templateUrl("airport"),controller:"AirportController",controllerAs:"airportCtrl",data:{title:"Аэрофлот Quest",tmplClass:"airport"},parent:"index"}).state("aircraft",{url:"/aircraft",templateUrl:templateUrl("aircraft"),controller:"AircraftController",controllerAs:"aircraftCtrl",data:{title:"Аэрофлот Quest",tmplClass:"aircraft"},parent:"index"}).state("loser",{url:"/loser",templateUrl:templateUrl("loser"),controller:"LoserController",controllerAs:"loserCtrl",data:{title:"Аэрофлот Quest",tmplClass:"loser"},parent:"index"})}]),angular.module("app").service("globalService",["$rootScope","localStorageService","$state","$location","$timeout","$interval","Notification","configApp","existingLocations",function(e,t,o,r,a,n,l,i,s){function c(){v=n(function(){i.timeLeft=i.timeLeft-6e4,t.set("configApp",i),i.timeLeft<0&&C.gameOver()},1e4)}function p(o,r,a,n,l){if(t.get("configApp")){if(t.get("currentLocation")&&~s.indexOf(t.get("currentLocation")))return o.preventDefault(),void e.$state.go(t.get("currentLocation"));t.clearAll(),location.reload()}else o.preventDefault(),e.$state.go("bedroom")}function u(e,o,r){i.timeLeft=i.timeLeft-6e4*e.takesTime,r[o].visible=!1,e.required&&angular.forEach(i.requiredObjects,function(t,o){t.name===e.name&&(t.found=!0,t.attention.show&&(t.attention.show=!1))}),l.success({message:e.tooltip+(e.required?"":" &ndash; <b>"+e.takesTime+" минут</b>"),delay:2e3,positionX:"center",positionY:"top"}),t.set("configApp",i)}function m(o,r,a){var n=function(){e.$state.go(r),t.set("currentLocation",r),a&&(i.timeLeft=i.timeLeft-6e4*a,t.set("configApp",i))};if(i.timeLeft<6e4*a)return void C.gameOver();switch(r){case"street":h("keys")&&n();break;case"taxi":h("purse")&&n();break;case"railway-station":switch(o){case"street":h("troika")&&n();break;case"taxi":h("purse")&&n()}break;case"aeroexpress":h("purse")&&n();break;case"aircraft":h("passport"),h("baggage"),h("passport")&&h("baggage")&&(i.gameStatus.win=!0,n());break;default:n()}}function g(e){angular.forEach(i.requiredObjects,function(t,o){t.name===e.name&&t.attention.show&&(t.attention.show=!1)}),t.set("configApp",i)}function d(){i.gameOn=!0,t.set("configApp",i),t.set("currentLocation","bedroom"),C.timerInterval()}function f(){e.$state.go("loser"),i.gameStatus.fail=!0,t.set("currentLocation","loser"),i.timeLeft=0,t.set("configApp",i),n.cancel(v)}function b(){t.clearAll(),location.reload()}function h(e){var t=!1;return angular.forEach(i.requiredObjects,function(o){o.name===e&&(o.found?t=!0:(o.attention.show=!0,a(function(){o.attention.show=!1},5e3),t=!1))}),t}var C=this,v=void 0;C.timerInterval=c,C.checkQuestStatus=p,C.takeObject=u,C.goAnotherLocation=m,C.hideAttention=g,C.gameOn=d,C.gameOver=f,C.playAgain=b,C.timerInterval=c,t.get("configApp")&&t.get("configApp").gameOn&&C.timerInterval()}]).factory("configApp",["localStorageService",function(e){return e.get("configApp")||{timeLeft:108e5,gameOn:!1,gameStatus:{win:!1,fail:!1},requiredObjects:[{name:"keys",attention:{show:!1,content:"Вы не взяли ключи,<br>нужно найти их"},found:!1},{name:"purse",attention:{show:!1,content:"Вы забыли кошелек,<br>необходимо вернуться<br>за ним домой"},found:!1},{name:"passport",attention:{show:!1,content:"Вы забыли паспорт,<br>необходимо вернуться<br>за ними домой"},found:!1},{name:"phone",attention:{show:!1,content:"Вы забыли смартфон"},found:!1},{name:"troika",attention:{show:!1,content:'Вы забыли карту "Тройка"<br>необходимо вернуться<br>за ней домой'},found:!1},{name:"baggage",attention:{show:!1,content:"Вы забыли багаж,<br>необходимо вернуться<br>за ним домой"},found:!1}],allObjects:{bedroom:[{visible:!0,name:"baggage",takesTime:0,tooltip:"Вы взяли свой багаж",required:!0},{visible:!0,name:"jug",takesTime:2,tooltip:"Выпили стакан воды",required:!1},{visible:!0,name:"purse",takesTime:0,tooltip:"Вы взяли кошелек",required:!0},{visible:!0,name:"book-1",takesTime:5,tooltip:"Убрали книгу на место",required:!1},{visible:!0,name:"dumbbells",takesTime:20,tooltip:"Сделали утреннюю зарядку",required:!1},{visible:!0,name:"book-2",takesTime:20,tooltip:"Почитали книгу",required:!1},{visible:!0,name:"troika",takesTime:0,tooltip:'Вы взяли карту "Тройка"',required:!0}],kitchen:[{visible:!0,name:"coffee-maker",takesTime:10,tooltip:"Выпили кофе",required:!1},{location:"street",visible:!0,name:"door",takesTime:5,tooltip:"Вы вышли из дома",required:!1},{visible:!0,name:"fruit",takesTime:10,tooltip:"Съели яблоко",required:!1},{visible:!0,name:"keys",takesTime:0,tooltip:"Вы взяли ключи",required:!0},{visible:!0,name:"laptop",takesTime:30,tooltip:"Посидели в соцсетях",required:!1},{visible:!0,name:"tv",takesTime:30,tooltip:"Посмотрели утренние новости",required:!1},{visible:!0,name:"flower",takesTime:10,tooltip:"Полили цветы",required:!1},{visible:!0,name:"phone",takesTime:0,tooltip:"Вы взяли смартфон",required:!0},{visible:!0,name:"passport",takesTime:0,tooltip:"Вы взяли паспорт",required:!0}]}}}]).factory("existingLocations",function(){return["bedroom","kitchen","street","taxi","railway-station","aeroexpress","airport","aircraft","loser"]}),angular.module("app").component("yandexShare",{bindings:{},templateUrl:"/views/yandexShare.html",controller:function(){}}),angular.module("app").filter("millisecToTime",function(){return function(e){var t=void 0,o=Math.floor((e/1e3).toFixed(0)/60);return t=Math.floor(o/60),o-=60*t,o=o>=10?o:"0"+o,{h:t||0,m:o}}}),AeroexpressController.$inject=["globalService"],angular.module("app").controller("AeroexpressController",AeroexpressController),AircraftController.$inject=["globalService"],angular.module("app").controller("AircraftController",AircraftController),AirportController.$inject=["globalService"],angular.module("app").controller("AirportController",AirportController),BedroomController.$inject=["globalService","configApp"],angular.module("app").controller("BedroomController",BedroomController),GlobalController.$inject=["configApp","globalService"],angular.module("app").controller("GlobalController",GlobalController),angular.module("app").controller("IndexController",IndexController),KitchenController.$inject=["globalService","configApp"],angular.module("app").controller("KitchenController",KitchenController),LoserController.$inject=["globalService"],angular.module("app").controller("LoserController",LoserController),RailwayStationController.$inject=["globalService"],angular.module("app").controller("RailwayStationController",RailwayStationController),StreetController.$inject=["globalService"],angular.module("app").controller("StreetController",StreetController),TaxiController.$inject=["globalService"],angular.module("app").controller("TaxiController",TaxiController);